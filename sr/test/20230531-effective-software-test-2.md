# 이펙티브 소프트웨어 테스팅 책을 읽고... (1)

`2장 명세 기반 테스트`와 `3장 구조적 테스트와 코드 커버리지`를 읽고 정리하였습니다.

일단 두 챕터는 1장에서 이야기한 개발의 전반적인 흐름 안에서 테스트에 대해서 어떻게 접근해야 할 지에 대해서 이야기 하고 있습니다.

## 2장 명세 기반 테스트

우선 개발은 요구사항을 정의하는 것으로 시작된다는 것을 알고 있다.

요구사항은 어떤 기능이 무엇을 해야하는지를 설명하는 텍스트 문서로, 
소프트웨어가 무엇을 수행해야 하고, 무엇을 수행해서는 안되는지를 정확하게 알려준다.
또한 소프트웨어가 구현하고, 검사해야하는 비즈니스 규칙의 복잡성을 기술한다.

따라서 요구사항으로부터 기능 구현을 시작했다면, 테스트를 작성하게 될 것이다.


- 테스트를 적용하는 순서
    - 요구사항 자체에서 테스트를 도출해내는 테스트 가능성을 고려한다.
    - 모든 입출력 조합을 테스트하는 명세 테스트를 진행한다.
      - 입력 값에 대한 경계 테스트를 진행한다.
    - 3장의 구조적 테스트를 진행한다.

### 2.1 단계별로 보는 명세 기반 테스트

#### 신규 기능이냐? 이미 구현된 기능이냐?

- 1단계: 요구사항과 입출력에 대한 이해
- 2단계: 여러 입력 값에 대해 프로그램이 수행하는 바를 탐색하기

- 요구사항의 구성
  1. 목표
  2. 매개변수 정의
  3. 반환 값 정의

#### 정상 케이스 찾기

- 3단계: 테스트 가능한 입출력과 구획을 탐색하기

- 매개변수
  - 입력 변수들의 가능한 조합 찾기
  - 도메인 분할하여 구획 찾기

> * 일부 입력 집합에 대해 특정 입력값에 관계없이 동일한 방식으로 동작한다면, 이를 "두 입력은 동등하다."라고 정의한다.

#### 비정상 케이스 찾기

- 4단계 경계 분석하기

- 경계 찾기
  1. 등식('>', '<', '>=', '<=') 을 다루는 경계

- 경계 발견 시
  1. 접점, 거점을 테스트한다.
  2. 외점을 테스트 한다.

- 경계 테스트
  1. 일반적인 값보다 경계 근처에서 발생하는 버그를 만들 확률이 높다.
  2. 경계 위에 있는 접점(on point)
  3. 경계에 가장 가까운 점 이면서, 접점이 속해있지 않은 구획(거점, off point)
  4. 조건이 참인 내점(in point)
  5. 조건이 거짓인 외점(out point)


#### 자동화 테스트

- 5단계: 테스트 케이스 고안하기
- 6단계: 테스트 케이스 자동화하기

- 실용성을 위해 몇 가지 테스트 규칙을 정의
  1. 무작정 조합하지 않기
  2. 예외 케이스
  3. 경계 케이스
  4. 일반(정상) 케이스

- 테스트 자동화
  1. JUnit과 같은 테스트 프레임워크를 사용
  2. 테스트 스위트(test suite)를 만들어서 테스트를 실행한다.


#### 검증하기

- 7단계: 창의성과 경험을 발휘해서 테스트 스위트 강화하기

- 명세 기반 테스트 재정립
  1. 요구사항의 이해
  2. 프로그램 탐색
  3. 구획 식별
  4. 경계 분석
  5. 테스트 케이스 고안
  6. 테스트 자동화
  7. 테스트 케이스 강화


## 3장 구조적 테스트와 코드 커버리지

- 명세 기반 테스트 이후 할 일은 소스 코드를 활용해서 `테스트 스위트를 확장하는 것(구조적 테스트)`이다.

```text
* 소스코드를 체계적으로 활용하는 방법과 명세를 통해 도출한 테스트 스위트를 수행할 때 일어나는 일,
  그리고 남아 있는 테스트가 무엇인지 배운다.
* 소스 코드의 구조를 사용하여 테스트를 도출하는 것을 구조적 테스트라 한다.
* 구조적 테스트 기법을 이해한다는 것은 커버리지 기준을 이해한다는 것이다.
```

> 최종 목표는 코드 커버리지 정보를 사용하여, 프로그램이 예상대로 동작한다는 확신을 갖는 과정

### 구조적 테스트에 대해서 간략하게 알아보기

1. 명세 기반 테스트 수행
2. 구현 사항을 읽고, 개발자의 주요 결정사항을 이해한다.
3. 테스트 케이스를 코드 커버리지 도구로 수행한다.
4. 테스트가 수행되지 않은 코드
   1. 왜 코드가 수행되지 않았는지 이해.
   2. 테스트할 가치가 있는지 결정
   3. 자동화된 테스트 케이스를 구현
5. 고안할 만한 다른 흥미로운 테스트가 있는지 확인
   1. 확인되면 4단계 하위 단계를 수행

> 구조적 테스트는 명세 기반 테스트로 고안한 테스트 스위트를 보강한다는 것

### 코드 커버리지 기준

1. 코드 줄 커버리지
2. 분기 커버리지
3. 조건 + 분기 커버리지
4. 경로 커버리지

### 명세 기반 테스트와 구조적 테스트

- 요구사항으로부터 도출
  1. 목표
  2. 매개변수 정의
  3. 반환 값 정의
  
- 구획 도출
  - 매개변수 별 입력 가능한 경우의 수

- 경계 도출
  - 테스트 케이스 고안하기 (실용주의)
  - 테스트 스위트 강화 (구조적 테스트 ⭐️)
    - 놓칠 수 있을 법한 구획과 경계를 찾도록 도움

### 경계 테스트와 구조적 테스트

- 구조적 테스트
  - 접점 및 거점을 찾아내고 테스트를 수행

- 구조적 테스트의 맹점
  - 분기 코드 커버리지 100% 달성은 특이 케이스의 입력 값에 대한 테스트를 보장할 수 없다.
  - 따라서 맹목적으로 코드 커버리지에 대한 수치를 신뢰해서는 안된다.

### 무엇을 수행하지 말아야 할까?

1. 자바 클래스의 equals & hashCode, getter, setter
2. 테스트를 통해 얻을 수 있는 로직이 아닌 경우

> * 모든 코드는 다른 방식으로 증명될 때까지 수행되어야 한다. 