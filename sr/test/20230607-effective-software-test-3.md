# 이펙티브 소프트웨어 테스팅 책을 읽고... (3)

- 어떤 입력 가능한 몇 가지 사례를 입력해보는 예시 기반 테스트를 작성하는 방식은 예상치 못한 값을 찾아내기 어렵다.
  (이미 내 머릿속은 정상 케이스에 대한 값들만 꽉차 있다.)

> - 명세 기반 테스트에서 이야기 했던 것처럼 테스트 프레임워크는 단지 실행하고, 결과물을 리포트 한다는 이야기를 했었다.
> - 테스트를 설계하는 작업은 개발자의 몫으로 창의성있는 다양한 케이스는 많은 시간을 투자하여 테스트 케이스를 작성해야 한다.

 * 이제부터는 [jqwik](https://jqwik.net) 라는 라이브러리를 통해 `테스트하고자 하는 속성을 표현`만 하고, `테스트 프레임워크가 구체적인 예시를 선택하여 테스트를 진행`해본다.

## 5. 속성 기반 테스트

속성 기반 테스트는 테스트할 대상의 속성을 정의하고, 그 속성을 만족하는 모든 입력값을 생성해내는 방식이다.

속성 기반 테스트에 대한 학습 테스트를 작성해보는 방식은 다음과 같다.

1. 파라미터의 구획(정상/실패 케이스)을 정의
2. 정상 케이스의 상세 구획(정상 범위 내에서도 결과 값이 달라지는 범주)의 정의
3. jqwik 라이브러리를 통해 @Property, @Provide 등을 정의하여 상세 구획에 대한 속성 기반 테스트를 작성

### jqwik 매개변수 랜덤 생성 작성

기본 파라미터 설정 참고

- [Default Parameter Generation](https://jqwik.net/docs/current/user-guide.html#default-parameter-generation)
- [Customized Parameter Generation](https://jqwik.net/docs/current/user-guide.html#customized-parameter-generation)

> 테스트의 전반적인 개념은 무작위로 값을 삽입해보는 것이다.

---

### jqwik 메서드 랜덤 수행 작성

- 무작위 행동을 일으키는 테스트 방법

테스트 케이스에서 몇 가지 동작을 테스트할 때, 다양한 동작을 정의하는 jqwik의 액션(Action) 사용법

- [Stateful Testing](https://jqwik.net/docs/current/user-guide.html#stateful-testing)

> 프로덕션 코드가 아니라, 테스트를 위해 메서드를 추가하는 것은 좋지 않은 생각이라 할 수 있지만, 이는 트레이드 오프 문제이다.

---

### 예시 기반 테스트 vs 속성 기반 테스트

지금까지 명세 기반 테스트 / 예시 기반 테스트, 구조적 테스트, 속성 기반 테스트 등등 설명하고 있다.

하나씩 필요한 것을 가져다 쓰면 된다는 식이 아니라, 책에서 이야기 하고 싶은 내용은 흐름을 생각하면서 필요한 테스트를 적절하게 사용하는 것이다.

흐름을 보면 개발시에는 우선 `명세 기반 테스트`와 `구조적 테스트`를 수행하고, 단순하고 자동화에 창의성이 필요하지 않은 `예시 기반 테스트`를 우선적으로 사용하고, 두 테스트 기법을 모두 적용해서 테스트 대상 프로그램을 훨씬 잘 파악하게 되면, 어떤 테스트 케이스가 `속성 기반 테스트`로 더 나을지 평가한다.

항상 속성 기반 테스트를 해야 하는 것은 아니다. 확신할 수 없는 경우 속성 기반 테스트를 사용한다.

---

- 속성 기반 테스트를 작성할 때의 유의사항
  - "내가 최대한 실제 동작과 가깝게 속성을 동작시키고 있는가?"
  - 테스트가 모든 구획을 같은 비율로 수행하고 있는가?

- 속성 기반 테스트의 장점
  - 매개변수 간에 상호작용을 테스트 해야하는 모든 경우의 수에 대한 테스트 케이스를 쉽게 작성할 수 있도록 돕는다.

- 속성 기반 테스트의 단점
  - 오픈소스 시스템에서 인기가 덜 한 이유가 있을 것이다.
  - 모든 경우의 수를 테스트한다는 것은 테스트 실행에 많은 시간이 소요된다는 것이다.

- 속성 기반 테스트의 일반적인 문제
  - 매우 비용이 많이 들거나 심지어 불가능한 데이터를 생성하도록 jqwik에게 요구하는 것
  - jqwik를 통해 경계값을 테스트하는 것 또한 개발자가 속성과 경계를 올바르게 표현하는 경우에만 잘 작동한다.
  - 테스트 대상 메서드에 전달할 입력 데이터가 가능한 모든 옵션 간에 균등하게 분포되어 있는지 확인하는 하였는가?

