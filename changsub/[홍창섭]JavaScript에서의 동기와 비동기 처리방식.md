# \<JavaScript\> ë™ê¸°/ë¹„ë™ê¸°ì™€ CallBack,Promise and Async/Await
## ë™ê¸°ì™€ ë¹„ë™ê¸°(Sync,Async)
- ë™ê¸°ì  : ë§ ê·¸ëŒ€ë¡œ ì–´ë– í•œ ì¼ë“¤ì´ ë™ì‹œì— ì¼ì–´ë‚œë‹¤ëŠ” ëœ»ì´ë‹¤. ì¼ìƒì—ì„œ ì ‘í•  ìˆ˜ ìˆëŠ” ë™ê¸°í™”ì˜ ì–´ì›ì´ë¼ ë³¼ ìˆ˜ ìˆìœ¼ë©°, ìš”ì²­ê³¼ ë™ì‹œì— ê·¸ ì‘ë‹µì´ ìš”ì²­ì„ ìš”êµ¬í•œ ìë¦¬ì— ì‹œê°„ê³¼ ê´€ê³„ì—†ì´ ì£¼ì–´ì ¸ì•¼ í•œë‹¤. ì¦‰, ìš”ì²­ê³¼ ì‘ë‹µì„ ì„œë¡œ í™•ì¸í•˜ëŠ”ê²Œ ì¤‘ìš”í•´ì„œ ì¼ì˜ ìˆœì„œê°€ ë³´ì¥ì´ ë˜ì–´ì•¼í•œë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ ì‘ë‹µì´ ì˜¬ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•œë‹¤ëŠ” ë‹¨ì ì´ ì¡´ì¬í•œë‹¤.(TCP í†µì‹  ë°©ì‹ê³¼ ë¹„ìŠ·í•œì ì´ ìˆë‹¤ê³  ì´í•´í•´ë„ ì¢‹ë‹¤!)
- ë¹„ë™ê¸°ì  : ìš”ì²­ê³¼ ì‘ë‹µì´ ë™ì‹œì— ì¼ì–´ë‚˜ì§€ ì•ŠëŠ”ë‹¤. ì‘ë‹µì´ ì˜¤ì§€ ì•Šì•„ë„ ìƒˆë¡œìš´ ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.
```js
//ë¹„ë™ê¸°ì‹ í”„ë¡œê·¸ë˜ë° 1->3->2 ìˆœìœ¼ë¡œ ì½˜ì†”ì— ì°íŒë‹¤.
console.log('1')
setTimeout(function() {
    console.log('2')
},1000)
console.log('3')
```
- ìˆ˜ë§ì€ ë°ì´í„°ë¥¼ ì „ì†¡í•´ì•¼í•˜ëŠ” ì›¹ í™˜ê²½ì—ì„œ ë™ê¸°ì ì¸ ë°©ì‹ì€ ì‚¬ìš©ìì—ê²Œ ë„ˆë¬´ ë§ì€ ëŒ€ê¸° ì‹œê°„ì„ ë¶€ì—¬í•˜ê¸°ì— í•œë²ˆì— ì—¬ëŸ¬ê°œì˜ ì¼ì„ ìˆ˜í–‰í•˜ëŠ” ë¹„ë™ê¸°ì‹ ë°©ì‹ì´ ì±„íƒë˜ì–´ ë§ì´ ì‚¬ìš©ë˜ê³  ìˆìŠµë‹ˆë‹¤.

## ìë°” ìŠ¤í¬ë¦½íŠ¸ì—ì„œì˜ ë¹„ë™ê¸° êµ¬í˜„ ë°©ì‹ 3ê°€ì§€
### ì½œë°±í•¨ìˆ˜ ì‚¬ìš©
- íŠ¹ì •í•¨ìˆ˜ì— ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬ëœ í•¨ìˆ˜ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.ì¦‰, ë‚˜ì¤‘ì— í˜¸ì¶œë  í•¨ìˆ˜ë“¤ì´ë¼ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ìŒì‹ì ì„ ì˜ˆì•½í•˜ëŠ” í–‰ìœ„ì™€ ë¹—ëŒ€ì–´ ì„¤ëª…ì´ ê°€ëŠ¥í•˜ë‹¤.ëŒ€ê¸°ìê°€ ìˆëŠ” ë§›ì§‘ì„ ì°¾ì•„ê°”ë‹¤ê³  ê°€ì •í•´ë³´ì. ì‚¬ëŒì´ ë§ì•„ì„œ ìŒì‹ì ì„ ì˜ˆì•½í•˜ê³  ë‚˜ë©´ ì‹¤ì œ ì˜ˆì•½ì‹œê°„ì— ë„ë‹¬í•˜ê¸° ì „ê¹Œì§€ëŠ” ë‹¤ì–‘í•œ ì¼ë“¤ì„ í•  ìˆ˜ ìˆë‹¤.(ê·¼ì²˜ì—ì„œ ì‡¼í•‘ì„ í•˜ê±°ë‚˜ ì¹´í˜ë¥¼ ê°€ê±°ë‚˜ ë“±ë“±)ì´ ë•Œ ìŒì‹ì ìœ¼ë¡œë¶€í„° ë‚´ ì°¨ë¡€ê°€ ë˜ì—ˆë‹¤ê³  ì „í™”ê°€ ì˜µë‹ˆë‹¤. ì´ë•Œë¥¼ ì½œë°±í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ëŠ” ì‹œê¸°ë¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.ìë¦¬ê°€ ë‚¬ë‹¤ëŠ” ì¡°ê±´ì„ ë§Œì¡±í• ë•Œ ì €í¬ëŠ” ë°¥ì„ë¨¹ëŠ” í–‰ìœ„ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆìœ¼ë©°, ì¡°ê±´ì´ ë§Œì¡±ë˜ê¸° ì „ê¹Œì§€ëŠ” ììœ ë¡­ê²Œ ë‹¤ë¥¸ ì¼ë“¤ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.ì¦‰ ë°ì´í„°ê°€ ì¤€ë¹„ëœ ì‹œì ì—ì„œë§Œ ì €í¬ê°€ ì›í•˜ëŠ” ë™ì‘ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ìœ„ì˜ setTimeout ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œ ë°©ì‹ë„ ì½œë°±ì´ë¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```js
function Callback(callback){
    console.log('callback function');
    callback();
}
Callback(function(){
    console.log('callback í˜¸ì¶œ');
})
```
- í•˜ì§€ë§Œ ì•„ë˜ì™€ ê°™ì´ ê°€ë…ì„±ì´ ì¢‹ì§€ì•Šë‹¤ëŠ” ë‹¨ì ì´ ì¡´ì¬í•œë‹¤.
```js
function Callback(callback){
    function Callback2(callback){
        function Callback3(callback){
            console.log('ë¬´í•œì½œë°±');
        }
    }
}
```
### Promise
- Promise ê°ì²´ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ë¹„ë™ê¸°ì ì¸ í”„ë¡œê·¸ë˜ë°ì„ ìœ„í•´ ì‚¬ìš©ëœë‹¤.
- promiseëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì½œë°±ê³¼ í•˜ëŠ”ì¼ ë™ì¼í•˜ë‹¤.í•˜ì§€ë§Œ ì•„ë˜ì™€ ê°™ì´ .then()ì„ í˜¸ì¶œí•œë‹¤.ì´ëŠ” ì—°ì†ì ìœ¼ë¡œ ë©”ì†Œë“œë“¤ì„ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ì¡´ì¬í•œë‹¤.ë”°ë¼ì„œ ì½œë°±ê³¼ ê¸°ëŠ¥ì€ ë™ì¼í•˜ì§€ë§Œ í›¨ì”¬ ê°„ê²°í•˜ê³  ê°€ë…ì„±ì´ ì¢‹ì•„ì§„ë‹¤.
#### Promiseì˜ ì„¸ê°€ì§€ ìƒíƒœ(States)
1. Pending(ëŒ€ê¸°) : ë¹„ë™ê¸° ì²˜ë¦¬ ë¡œì§ì´ ì•„ì§ ì™„ë£Œë˜ì§€ ì•Šì€ ìƒíƒœ
2. Fulfilled(ì´í–‰) : ë¹„ë™ê¸° ì²˜ë¦¬ ë¡œì§ì´ ìˆ˜í–‰ì™„ë£Œë˜ì–´ ê²°ê³¼ ê°’ì„ ë°˜í™˜í•œ ìƒíƒœ
3. Rejected(ì‹¤íŒ¨) : ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ì‹¤íŒ¨í•˜ê±°ë‚˜ ì—ëŸ¬ê°€ ë°œìƒí•œ ìƒíƒœ
#### Pending ìƒíƒœ ì˜ˆì‹œ
- ì•„ë˜ì™€ ê°™ì´ Promise ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ì‹œì ë¶€í„° Pendingìƒíƒœì´ë‹¤.
- ë˜í•œ ì½œë°±í•¨ìˆ˜ì˜ ì¸ìë¡œì„œ resolve,rejectë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤.
```js
new Promise(function(resolve, reject) {
  // ...
}); 
```
####  Fulfilled ìƒíƒœ ì˜ˆì‹œ
- ìœ„ì˜ ì½œë°±í•¨ìˆ˜ ì¸ì ì¤‘ Resolveë¥¼ ì•„ë˜ì™€ ê°™ì´ ì‹¤í–‰í•˜ë©´ Fulfilled ìƒíƒœë¡œ ë“¤ì–´ê°„ë‹¤.
- ë˜í•œ Fulfilled ìƒíƒœê°€ë˜ë©´ ì•„ë˜ì˜ then()ë©”ì„œë“œë¥¼ ì´ìš©í•œ ì²´ì´ë‹ì´ ê°€ëŠ¥í•˜ë‹¤.
```js
new Promise(function(resolve, reject) {
	resolve(); 
}); 
```
#### Rejected ìƒíƒœ ì˜ˆì‹œ
- ì½œë°±í•¨ìˆ˜ì˜ ì¸ì ì¤‘ reject()ë¥¼ ì¸ìë¡œ ë°›ìœ¼ë©´ Rejected ìƒíƒœë¡œ ë“¤ì–´ê°„ë‹¤.
- ì–´ë– í•œ ë¹„ë™ê¸° ë¡œì§ì´ ê±°ì ˆì´ ëœ ìƒíƒœë¡œ, ì—ëŸ¬ì— ëŒ€í•œ ì˜ˆì™¸ì²˜ë¦¬ê°€ ê°€ëŠ¥í•´ì§„ë‹¤.
- ë‘ë²ˆì§¸ ì˜ˆì‹œì²˜ëŸ¼ then()ë©”ì„œë“œì˜ ê²°ê³¼ê°’ì„ ë³´ê³ , rejectê°€ ë‚˜ì˜¤ë©´ ë°œìƒí•œ ì—ëŸ¬ë¥¼ catch ë©”ì„œë“œë¡œ ë°›ê³  ì´í›„ ë™ì‘ì„ ìˆ˜í–‰ í•  ìˆ˜ ìˆë‹¤.
```js
new Promise(function(resolve, reject) {
	rejected(); 
}); 
```

```js
function getData() {
  return new Promise(function(resolve, reject) {
    reject(new Error("Request is failed"));
  });
}

// reject()ì˜ ê²°ê³¼ ê°’ Errorë¥¼ errì— ë°›ìŒ
getData().then().catch(function(err) {
  console.log(err); // Error: Request is failed
});
```
#### ê¸°ë³¸ì ì¸ Promise êµ¬ì¡°
```js
//1. Producer
//When new Promise is created, the executor runs automatically
const promise = new Promise((resolve,reject) =>{
    //doing someting heavy work (network or data)
    console.log("Doing Something")
    setTimeout(()=>{
        resolve('brido');
        //reject(new Error("network error"));
    },2000)
})

//2. Consumer: then, catch, finally
promise
.then((value) => {
    console.log(value);
})
.catch(error => {
    console.lot(error);
})
.finally(()=>{
    console.log("finally")
})
```
#### Promise Chaining
```js
function add10(a) {
  return new Promise(resolve => setTimeout(() => resolve(a + 10), 100));
} //Promiseì‚¬ìš© ì‹œ ì‘ì—…ì´ ëë‚¬ìŒì„ ì•Œë ¤ì£¼ëŠ” resolveë¥¼ ì¸ìë¡œ ë°›ì•„ë“¤ì„.
add10(10)
  .then(add10)
  .then(add10)
  .then(add10)
  .then((res) => console.log(res))
```
### Async/Await
- ê°€ì¥ ìµœê·¼ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²•ì— ì¶”ê°€ëœ ë¹„ë™ê¸° ì²˜ë¦¬ íŒ¨í„´ì…ë‹ˆë‹¤.ê¸°ì¡´ì˜ ì½œë°±ê³¼ Promiseì˜ ë‹¨ì ì„ ë³´ì™„í•˜ê¸°ìœ„í•´ íƒœì–´ë‚¬ë‹¤ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- íŠ¹íˆ ê°€ë…ì„± ë¶€ë¶„ì„ ì§‘ì¤‘ì ìœ¼ë¡œ ë³´ì™„í•œ ë¬¸ë²•ì…ë‹ˆë‹¤. ì¦‰, ê¹”ë”í•˜ê²Œ Promiseë¥¼ ì‚¬ìš©í• ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
- Asyncì™€ Awaitì„ ì‚¬ìš©í•˜ë ¤ë©´ ìš°ì„  ì‚¬ìš©í•  í•¨ìˆ˜ ì•ì— asyncë¼ëŠ” í‚¤ì›Œë“œë¥¼ ë¶™ì—¬ ì‚¬ìš©í•´ì•¼ í•˜ë©° ì„ ì–¸ëœ async í•¨ìˆ˜ ì•ˆì—ì„œë§Œ await í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
#### async & await ê¸°ë³¸ ë¬¸ë²•
- ë¨¼ì € í•¨ìˆ˜ì˜ ì•ì— asyncë¼ëŠ” ì˜ˆì•½ì–´ë¥¼ ì”ë‹ˆë‹¤.ê·¸ë¦¬ê³  í•´ë‹¹ í•¨ìˆ˜ ë‚´ì—ì„œ ë¹„ë™ê¸° ì²˜ë¦¬ ë¡œì§ì„ ìˆ˜í–‰í•˜ëŠ” ë©”ì„œë“œ ì•ì— await ì˜ˆì•½ì–´ë¥¼ ë¶™ì—¬ì¤ë‹ˆë‹¤.
- ì—¬ê¸°ì„œ ë¹„ë™ê¸° ì²˜ë¦¬ ë©”ì„œë“œëŠ” ê¼­ Promiseê°ì²´ë¥¼ ë°˜í™˜í•´ì•¼ í•©ë‹ˆë‹¤.
```js
async function í•¨ìˆ˜ëª…() {
  await ë¹„ë™ê¸°_ì²˜ë¦¬_ë©”ì„œë“œ_ëª…();
}
```
#### Async/Await ê°„ë‹¨í•œ ì˜ˆì œ 1
```js
function add10(a){
    return new Promise(resolve => setTimeout(() => resolve(a + 10),100));
}

async function f1() {
  const a = await add10(10);
  const b = await add10(a);
  console.log(a, b)
}
f1();
```
#### Async/Await ê°„ë‹¨í•œ ì˜ˆì œ 2
```js
function delay(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }
  //2ì´ˆë™ì•ˆ ê¸°ë‹¤ë¦¬ê²Œ í•˜ê³  ì‚¬ê³¼ë¥¼ ë¦¬í„´í•˜ëŠ” ë©”ì„œë“œ
  async function getApple() {
    await delay(2000);
    return 'ğŸ';
  }
  //1ì´ˆë™ì•ˆ ê¸°ë‹¤ë¼ê²Œ í•˜ê³  ì‚¬ê³¼ë¥¼ ë¦¬í„´í•˜ëŠ” ë©”ì„œë“œ
  async function getBanana() {
    await delay(1000);
    return 'ğŸŒ';
  }
getApple().then(console.log);
getBanana().then(console.log);
```
### Reference
- [https://joshua1988.github.io/web-development/javascript/promise-for-beginners/](https://joshua1988.github.io/web-development/javascript/promise-for-beginners/ "ìº¡í•€íŒêµ-ìë°”ìŠ¤í¬ë¦½íŠ¸ Promise ì‰½ê²Œ ì´í•´í•˜ê¸°")
