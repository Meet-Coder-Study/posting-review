# HTTP μΊμ‹±

**μΊμ‹λ” μ–΄λ–»κ² λ™μ‘ν• κΉ?**

- μΊμ‹κ°€ μ΅΄μ¬ν•μ§€ μ•λ”λ‹¤λ©΄ μ–΄λ–»κ² μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈλ” ν†µμ‹ ν• κΉ?
    - λ°μ΄ν„°κ°€ λ³€κ²½λμ§€ μ•μ•„λ„ κ³„μ† λ„¤νΈμ›ν¬λ¥Ό ν†µν•΄μ„ λ°μ΄ν„°λ¥Ό λ‹¤μ΄λ΅λ“ λ°›μ•„μ•Ό ν•λ‹¤.
    - μΈν„°λ„· λ„¤νΈμ›ν¬λ” λ§¤μ° λλ¦¬κ³  λΉ„μ‹Έλ‹¤.
    - λΈλΌμ°μ € λ΅λ”© μ†λ„κ°€ λλ¦¬λ‹¤.
    - λλ¦° μ‚¬μ©μ κ²½ν—

**μΊμ‹λ¥Ό μ μ©ν•λ‹¤λ©΄?**

```
cache-control: max-age=60
```

μ„ μμ λ” μΊμ‹μ μƒλ…μ£ΌκΈ°λ¥Ό 60(μ΄)λ΅ μ§€μ •ν•μ€λ‹¤.

μ¦‰, 60μ΄ μ•μ— μ›ΉλΈλΌμ°μ €μ— λ‘κ°™μ€ λ¦¬μ†μ¤λ¥Ό μ”μ²­ν•λ‹¤λ©΄, λΈλΌμ°μ €λ” μΊμ‹μ—μ„ λ¦¬μ†μ¤λ¥Ό κ°€μ Έμ¨λ‹¤.



**π± μƒλ…μ£ΌκΈ°λ΅λ§ μΊμ‹λ¥Ό κ΄€λ¦¬ν•  λ• λ¬Έμ μ ?**

ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ κ°€μ§„ λ°μ΄ν„°κ°€ κ°™μ€ κ²½μ°μ—λ„ λ¶κµ¬ν•κ³ , λ¦¬μ†μ¤λ¥Ό λ‹¤μ‹ λ‹¤μ΄λ°›μ•„μ•Όν•λ‹¤.

μΊμ‹λ λ¦¬μ†μ¤μ λ³€κ²½μ‚¬ν•­μ„ μ •ν™•ν νμ•…ν•μ—¬ μΊμ‹λ¥Ό κ°±μ‹ ν•  μ μ—†μ„κΉ?



## κ²€μ¦ ν—¤λ” μ¶”κ°€ (Last-Modified)

- μ›Ή λΈλΌμ°μ €λ” GET /star.jpg λ΅ μ”μ²­

```
HTTP/1.1 200 OK
Content-Type: image/jpeg
cache-control: max-age=60 
**Last-Modified**: Thu, 04 Jun 2020 07:19:24 GMT
Content-Length: 34012

lkj123kljoiasudlkjaweioluywlnfdo912u34ljko98udjklasl kjdfl;qkawj9;o4ruawsldkal;skdjfa;ow9ejkl3123123
```

- Last-Modified ν—¤λ”λ” λ°μ΄ν„°μ μµμΆ… μμ •μΌμ„ μλ―Έν•λ‹¤.
- μΊμ‹ μ‹κ°„μ΄ μ΄κ³Όλκ³  λ‚λ©΄, μ›Ή λΈλΌμ°μ €λ” μ„λ²„μ— λ‹¤μ‹ λ¦¬μ†μ¤λ¥Ό μ”μ²­μ„ ν•λ©΄μ„ Last-modified λ΅ λ°›μ•λ κ°’μ„ if-modified-since ν—¤λ”λ¥Ό λ¶™μ—¬μ¤

```
GET /star.jpg
**If-modified-since**: Thu, 04 Jun 2020 07:19:24 GMT
```



- μ„λ²„λ” λ‚ μ§λ¥Ό λΉ„κµν•μ—¬ ν΄λΌμ΄μ–ΈνΈκ°€ if-modified-since ν—¤λ”λ΅ λ³΄λ‚Έ λ‚ μ§ μ΄ν›„λ΅ λ¦¬μ†μ¤κ°€ λ³€κ²½λμ§€ μ•μ•λ‹¤λ©΄, bodyκ°€ μ—†λ” **304 Not Modified**λ¥Ό λ³΄λ‚Έλ‹¤.

```
HTTP/1.1 **304 Not Modified**
Content-Type: image/jpeg
cache-control: max-age=60 
**Last-Modified**: Thu, 04 Jun 2020 07:19:24 GMT
Content-Length: 34012
```



π± **λ‚ μ§λ΅ μΊμ‹λ¥Ό κ΄€λ¦¬ν•λ” κ²ƒμ λ¬Έμ μ μ€?**

- 1μ΄ λ―Έλ§ λ‹¨μ„λ΅ μΊμ‹ μ΅°μ • λ¶κ°€λ¥
- λ‚ μ§ κΈ°λ° λ΅μ§μ΄ ν•„μ”ν•¨
- κ°™μ€ κ²°κ³Όλ¥Ό κ°–λ” λ°μ΄ν„°μ§€λ§ λ‚ μ§λ§ λ‹¬λΌμ§€λ” κ²½μ°
- μ„λ²„μ—μ„ λ³„λ„λ΅ μΊμ‹ λ΅μ§μ„ κ΄€λ¦¬ν•κ³  μ‹¶μ„ λ•



## **κ²€μ¦ ν—¤λ” μ¶”κ°€ (ETag)**

- Etag(Entity Tag)λ” λ°μ΄ν„°μ— μ„μμ κ³ μ ν• λ²„μ „μ„ λ‹¬μ•„λ‘λ” κ²ƒμ„
- λ²„μ „μ€ ν•΄μ‹λ¥Ό μ£Όλ΅ μ‚¬μ©ν•¨, ex) ETag: "v1.0", ETag: "a2gr35dwww"
- λ°μ΄ν„°κ°€ λ³€κ²½λ  λ• ETagλ¥Ό λ³€κ²½ν•¨
- λ‚ μ§λ¥Ό λΉ„κµν•λ” λ΅μ§ μ—†μ΄ λ‹¨μν ν•΄μ‹μ™€ κ°™μ€μ§€λ§ λΉ„κµν•  μ μλ‹¤.

```
GET /star.jpg
**If-None-Match**: "aaaaaaaaaa"
```

```
HTTP/1.1 304 Not Modified
Content-Type: image/jpeg
Cache-Control: max-age=60 
**ETag**: "aaaaaaaaaa" 
Content-Length: 34012
```



## ETag, If-None-Match μ •λ¦¬

- ν΄λΌμ΄μ–ΈνΈκ°€ νΉμ • λ¦¬μ†μ¤μ ETag μ„λ²„μ— λ³΄λ‚΄μ–΄ κ°™μΌλ©΄ μΊμ‹ μ μ§€, λ‹¤λ¥΄λ©΄ λ‹¤μ‹ λ°›κΈ°
- **μΊμ‹ μ μ–΄ λ΅μ§μ„ μ„λ²„μ—μ„ μ™„μ „ν κ΄€λ¦¬**
- ν΄λΌμ΄μ–ΈνΈλ” λ‹¨μν μ΄ κ°’μ„ μ„λ²„μ— μ κ³µν•  λΏμ„
- μ‹¤λ¬΄μ—μ„λ”, μ„λ²„μ—μ„λ” λ² νƒ€ μ¤ν” 3μΌ λ™μ• νμΌμ΄ λ³€κ²½λμ–΄λ„ ETagλ¥Ό λ™μΌν•κ² μ μ§€
- λλ”, μ• ν”λ¦¬μΌ€μ΄μ… λ°°ν¬ μ£ΌκΈ°μ— λ§μ¶° ETagλ¥Ό μ„λ²„μ—μ„ μΌκ΄„μ μΌλ΅ κ°±μ‹ ν•μ—¬ ν™μ©ν•  μ μμ

---

- Cache-Control: μΊμ‹λ¥Ό μ μ–΄ν•λ” λ¨λ“  ν—¤λ”
- Pragma: μΊμ‹λ¥Ό μ μ–΄(ν•μ„νΈν™)
- Expires: μΊμ‹ μ ν¨ κΈ°κ°„ μ μ–΄(ν•μ„νΈν™)

μΊμ‹ μ§€μ‹μ–΄(Directives)

- Cache-Control: max-age
    - μΊμ‹ μ ν¨ μ‹κ°„, μ΄ λ‹¨μ„
- Cache-Control: **no-cache**
    - λ°μ΄ν„°λ” μΊμ‹ν•΄λ„ λμ§€λ§, ν•­μƒ μ›(origin) μ„λ²„μ— κ²€μ¦ν•κ³  μ‚¬μ©
- Cache-Control: **no-store**
    - λ°μ΄ν„°μ— λ―Όκ°ν• μ •λ³΄κ°€ μμΌλ―€λ΅ μ €μ¥ν•λ©΄ μ•λ¨
    - λ©”λ¨λ¦¬μ—μ„ μ‚¬μ©ν•κ³  μµλ€ν• λΉ¨λ¦¬ μ‚­μ 

Pragma

- HTTP/1.0 ν•μ„νΈν™μ„ μ„ν•΄ μ‚¬μ©
- ex) Pragma: no-cache

Expires

- μΊμ‹ λ§λ£μΌμ„ μ§€μ •
- HTTP/1.0 ν•μ„νΈν™μ„ μ„ν•΄ μ‚¬μ©
- ex) expires: Mon, 01 Jan 1990 00:00:00 GMT
- μΊμ‹ λ§λ£μΌμ„ μ •ν™•ν• λ‚ μ§λ΅ μ§€μ •
- μ΄ λ‹¨μ„κ°€ ν›¨μ”¬ μ μ—°ν•λ―€λ΅ μ‚¬μ©ν•μ§€ μ•μ
- Cache-Control: max-ageκ°€ ν•¨κ» μ‚¬μ©λ  κ²½μ°, Expiresλ” λ¬΄μ‹λ¨

κ²€μ¦ ν—¤λ”(Validator)

- ETag: "v1.0"
- ETag: "asid912rtt5el"
- Last-Modified: Thu, 04 Jun 2020 08:12:43 GMT

μ΅°κ±΄λ¶€ μ”μ²­ ν—¤λ”

- If-Matchμ™€ If-None-Match ν—¤λ”λ” ETagλ¥Ό κ°’μΌλ΅ μ‚¬μ©
- If-Modified-Sinceμ™€ If-Unmodified-Since ν—¤λ”λ” Last-Modified κ°’μ„ μ‚¬μ©



## ν”„λ΅μ‹ μΊμ‹

- ν•κµ­μ— μλ” ν΄λΌμ΄μ–ΈνΈκ°€ λ―Έκµ­μ— μλ” Origin μ„λ²„μ— μ•½ 500 ms(0.5μ΄)λ§μ— μ ‘μ†ν•λ‹¤κ³  ν•΄λ³΄μ.
- ν”„λ΅μ‹ μΊμ‹ μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈμ™€ μ¤λ¦¬μ§„ μ„λ²„ μ¤‘κ°„μ— μ„μΉν•μ—¬ 0.5 μ΄λ³΄λ‹¤ λΉ λ¥΄κ² μ‘λ‹µν•  μ μλ‹¤.

- μ›Ή λΈλΌμ°μ € λ‚΄μ— μ„μΉν• μΊμ‹λ¥Ό **private μΊμ‹** λΌκ³  ν•λ‹¤.
- ν”„λ΅μ‹ μΊμ‹ μ„λ²„μ— μ„μΉν• μΊμ‹λ¥Ό **public μΊμ‹**λΌκ³  ν•λ‹¤.

μ„λ²„λ” μΊμ‹ μ§€μ‹μ–΄λ¥Ό μ΄μ©ν•μ—¬ μΊμ‹λ¥Ό λ‹¤μ–‘ν•κ² μ μ–΄ν•  μ μλ‹¤.

- Cache-Control: public
    - μ‘λ‹µμ΄ public μΊμ‹μ— μ €μ¥λ¨
- Cache-Control: private
    - μ‘λ‹µμ΄ ν•΄λ‹Ή μ‚¬μ©μλ§μ„ μ„ν• κ²ƒμ΄λ‹¤.
- Cache-Control: s-maxage
    - ν”„λ΅μ‹ μΊμ‹μ—λ§ μ μ©λλ” max-age
- Age: 60 (HTTP ν—¤λ”)
    - μ¤λ¦¬μ§„ μ„λ²„μ—μ„ μ‘λ‹µ ν›„ ν”„λ΅μ‹ μΊμ‹ λ‚΄μ— λ¨Έλ¬Έ μ‹κ°„(μ΄ λ‹¨μ„)



## μΊμ‹ λ¬΄ν¨ν™”

μΊμ‹ λ¬΄ν¨ν™”λ” μ›Ή λΈλΌμ°μ €κ°€ μ„μλ΅ μΊμ‹±ν•λ” κ²ƒμ„ λ§‰κΈ° μ„ν•΄ ν•„μ”ν•λ‹¤.

- Cache-Control: no-cache, no-store, must-revalidate
    - no-cache
        - λ°μ΄ν„°λ” μΊμ‹ν•΄λ„ λλ‹¤. ν•μ§€λ§ ν•­μƒ Origin μ„λ²„μ— κ²€μ¦ν•΄μ•Ό ν•λ‹¤.
    - no-store
        - λ―Όκ°ν• λ°μ΄ν„°μ΄λ―€λ΅ μ €μ¥ν•λ©΄ μ•λλ‹¤.
    - must-revalidate
        - μΊμ‹κ°€ λ§λ£λκ³  λ‚μ„, λ‹¤μ‹ ν•λ² μ΅°νμ‹ Origin μ„λ²„μ— κ²€μ¦ν•΄μ•Ό ν•λ‹¤.

- Pragma: no-cache
    - HTTP 1.0 ν•μ„νΈν™μ„ μ„ν• ν—¤λ”λ‹¤.



### no-cache vs must-revalidate

no-cacheμ™€ must-revalidateλ” Origin μ„λ²„μ μ •μƒ μ‘λ‹µμ‹μ—λ” λ™μ‘μ΄ λ™μΌν•λ‹¤.

**λ§μ•½, Origin μ„λ²„κ°€ μ‘λ‹µν•μ§€ μ•λ” κ²½μ° λ™μ‘μ΄ λ‹¤λ¥΄λ‹¤.**

no-cacheλ” Origin μ„λ²„μ— μ ‘κ·Όν•  μ μ—†λ” κ²½μ°, μ¤λ¥λ¥Ό μ‘λ‹µν•μ§€ μ•κ³  μ΄μ „ μΊμ‹ λ°μ΄ν„°λ¥Ό λ°ν™ν•  μλ„ μλ‹¤.

must-revalidateλ” **Origin μ„λ²„μ— μ ‘κ·Όν•  μ μ—†μ„ κ²½μ°, ν•­μƒ μ¤λ¥κ°€ λ°μƒμ‹ν‚¨λ‹¤.**

λν•, 504 Gateway Timeout μ„ μƒνƒμ½”λ“λ΅ λ°ν™ν•λ‹¤.



---

λ¨λ“  κ°λ°μλ¥Ό μ„ν• HTTP μ›Ή κΈ°λ³Έ μ§€μ‹ https://www.inflearn.com/course/http-μ›Ή-λ„¤νΈμ›ν¬/dashboard